<!DOCTYPE html>
<html>
<head>
	<title>REEFSOURCE</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Using the environment as a firsthand storytelling source">
	<link rel="stylesheet" type="text/css" href="css/foundation.css">
	<link rel="stylesheet" type="text/css" href="css/landingpage.css">
	<link rel="stylesheet" type="text/css" href="css/reveal.css">
	<script src="js/libs.js" type="text/javascript"></script>
	<!--<script type="text/javascript" src="js/jquery-1.4.4.min.js"></script>-->
	<!--<script type="text/javascript" src="js/jquery.reveal.js"></script>-->

	<script>
        // terrificjs bootstrap
        (function($) {
            $(document).ready(function() {
                var $page = $('body');
                var config = {
                    dependencyPath: {
                        plugin: 'javascripts/'
                    }
                }
                var application = new Tc.Application($page, config);
                application.registerModules();
                application.start();
            });
        })(Tc.$);
	</script>
	<!--Google Signin-->
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">

	<script src="https://apis.google.com/js/client:platform.js?onload=start" async defer></script>
	<script>
    	function start() {
			gapi.load('auth2', function() {
				auth2 = gapi.auth2.init({
					client_id: '198434096526-c806a42elrrhvl89g6b581tmjvbonu3n.apps.googleusercontent.com'
				});
			});
		}
	</script>

	<script src="js/masonry.pkgd.js" type="text/javascript"></script>


	<!--<script src="https://apis.google.com/js/api:client.js"></script>-->
	<!--<script>-->
        <!--var googleUser = {};-->
        <!--var startApp = function() {-->
            <!--gapi.load('auth2', function(){-->
                <!--// Retrieve the singleton for the GoogleAuth library and set up the client.-->
                <!--auth2 = gapi.auth2.init({-->
                    <!--client_id: '198434096526-c806a42elrrhvl89g6b581tmjvbonu3n.apps.googleusercontent.com',-->
                    <!--cookiepolicy: 'single_host_origin',-->
                    <!--// Request scopes in addition to 'profile' and 'email'-->
                    <!--//scope: 'additional_scope'-->
                <!--});-->
                <!--console.log(gapi.auth2.getAuthInstance().isSignedIn.get());-->
                <!--attachSignin(document.getElementById('customized_sign_in_button'));-->
            <!--});-->
        <!--};-->
        <!--function attachSignin(element) {-->
            <!--console.log(element.id);-->
            <!--auth2.attachClickHandler(element, {},-->
                <!--function(googleUser) {-->
                	<!--console.log(googleUser.getBasicProfile().getName());-->
                	<!--console.log(googleUser.getBasicProfile().getFamilyName());-->
                	<!--console.log(googleUser.getBasicProfile().getGivenName());-->
                	<!--console.log(googleUser.getBasicProfile().getEmail());-->
<!--//                	Save user name and jump to user dashbaord page.-->
                    <!--localStorage.setItem('user_name', googleUser.getBasicProfile().getGivenName());-->
                    <!--window.location.href = "dashboard.html";-->
                <!--}, function(error) {-->
                    <!--alert(JSON.stringify(error, undefined, 2));-->
                <!--});-->
        <!--}-->
	<!--</script>-->



	<!-- Google Analytics -->
	<script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-97189138-1', 'auto');
        ga('send', 'pageview');

	</script>
</head>

<body>

<div class="welcome">
	<div class="top-bar">
	  	<div class="top-bar-left">
	    	<ul class="dropdown menu" data-dropdown-menu>
	      		<li class="menu-text">RE<span>EF</span>SOURCE</li>
	      		<li class="mega-menu"><a data-toggle="mega-menu" href="index.html">LEARN</a></li>
	      		<li><a href="#">MAP</a></li>
				<li><a href="#">OUR MISSION</a></li>
	      		<li><a href="#">ABOUT US</a></li>
	      		<li><a href="#">CONTACT</a></li>
	      		<li id="sign-up-toggle"><a class="button" href="#" data-reveal-id="modal_signup">&nbsp;SIGN UP&nbsp;</a></li>
	    	</ul>
	  	</div>
	</div>
	<div class="land_sub">
		<p id="description">THE CROWD-SOURCING ENVIRONMENTAL PROJECT</p>
		<p id="subdescription">We care about coral reef health.</p>
		<a class="button contribute-button" href="#" data-reveal-id="modal_signup">CONTRIBUTE PHOTOS</a>
	</div>
</div>
<div class="support">
	<ul>
		<img src="img/brown-logo.png" style="height: 60px; transform: translateY(30%);">
		<img src="img/stanford-logo.png">
		<img src="img/columbia-logo.png">
		<img src="img/gopro-logo.png" style="margin-right: 0;">
	</ul>
</div>


<div id="modal_signup" class="reveal-modal" data-reveal aria-labelledby="Sign Up" aria-hidden="true" role="dialog">
  <p id="signup_title">SIGN UP</p>
  <p>By sending us. several text goes here.</p>
	<p><a href="#" class="button" id="customized_sign_in_button">SIGN UP WITH GOOGLE</a></p>

  <!--<p><a href="#" class="button" id="customized_sign_in_button">SIGN UP WITH GOOGLE</a></p>-->
  <a class="close-reveal-modal button" aria-label="Close">&#215;</a>
</div>




<script type="text/javascript">
	(function($) {

		$('#customized_sign_in_button').click(function() {
			auth2.grantOfflineAccess().then(signInCallback);
		});

		function signInCallback(authResult) {
		    console.log(authResult['code']);
		    localStorage.setItem("autho_db",authResult['code']);
			if (authResult['code']) {
				$.ajax({
					type: 'GET',
//					url:'http://ec2-184-72-166-124.compute-1.amazonaws.com/api/users/self',
					url :'./api/users/self',
//					url: 'http://coralreefsource.org/api/users/self',
					headers: {
						'X-Requested-With': 'XMLHttpRequest',
						'Authorization': authResult['code']
					},
					success: function(user) {
						console.log(user);
                 		onSignIn(user);
                    }
                });
            } else {
                 console.log('Authentication failure');
            }
        }
    })(Tc.$);
	function onSignIn(profile) {
		console.log('ID: ' + profile._id); // Do not send to your backend! Use an ID token instead.
		console.log('Name: ' + profile.firstname + ' ' + profile.lastname);
		console.log('Image URL: ' + profile.avatars['provider']);
		console.log('Email: ' + profile.email);
		var listvalues = {"Name": profile.firstname + ' ' + profile.lastname, "Email": profile.email};
        localStorage.setItem('user_name', profile.firstname);
		localStorage.setItem('lists', JSON.stringify(listvalues));
		document.getElementById("sign-up-toggle").style.display = "none";
        window.location.href="dashboard.html";
	}
//        document.getElementById("user_on_page").style.display = "block";

</script>
<!--<script>startApp();</script>-->
<script type="text/javascript" src="js/vendor/foundation.min.js"></script>
<script type="text/javascript" src="js/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="js/jquery.reveal.js"></script>
<script type="text/javascript" src="js/app.js"></script>
</body>
</html>